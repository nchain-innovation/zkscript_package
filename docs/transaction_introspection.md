# Transaction introspection

The class [TransactionIntrospection](../src/zkscript/transaction_introspection/transaction_introspection.py#L35) implements methods to generate Bitcoin scripts that achieve transaction introspection.

All the methods implemented by the class are static methods. The class is a building block for constructing more complex scripts that enforce conditions on the spending of a specific UTXO.

The class `TransactionIntrospection` implements two methods:
- [`pushtx`](../src/zkscript/transaction_introspection/transaction_introspection.py#L39)
- [`pushtx_bit_shift`](../src/zkscript/transaction_introspection/transaction_introspection.py#L1141)

Both methods generate scripts that achieve transaction introspection. The only difference between the two is the script size, and the amount of work required to generate the unlocking script. The script generated by `pushtx_bit_shift` is smaller ($82$ bytes versus $376$ for `pushtx`), but it requires on average slightly more than $4$ attempts to generate a valid unlocking script. We refer to the documentation and the blogposts:
- [OP_CHECKSIG beyond signature validation: covenants, transaction introspection and PUSHTX](https://hackmd.io/@federicobarbacovi/By6zkFmfyl)
- [OP_CHECKSIG beyond signature validation: a more efficient PUSHTX](https://hackmd.io/@federicobarbacovi/H1DqEzfm1l)

for a detailed explanation.

The unlocking scripts for the methods contained in the class `TransactionIntrospection` can be generated using the unlocking keys found in [src/zkscript/types/unlocking_keys/transaction_introspection](../src/zkscript/script_types/unlocking_keys/transaction_introspection.py). There are two unlocking keys, one for each script:
- [`PushTxUnlockingKey`](../src/zkscript/script_types/unlocking_keys/transaction_introspection.py#L14), for the script generated by the method `pushtx`.
- [`PushTxBitShiftUnlockingKey`](../src/zkscript/script_types/unlocking_keys/transaction_introspection.py#L56), for the script generated by the method `pushtx_bit_shift`.