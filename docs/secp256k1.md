# Efficient operations on secp256k1

The class [`Secp256k1`](https://github.com/nchain-innovation/zkscript_package/blob/39c6ce92c659f6aaeed1d295138f8c567a6be4f0/src/zkscript/elliptic_curves/secp256k1/secp256k1.py#L42) implements methods to efficiently verify scalar point multiplications on the curve secp256k1.

All the methods implemented by `Secp256k1` are class methods. The following public methods are implemented:
- [`verify_base_point_multiplication`](https://github.com/nchain-innovation/zkscript_package/blob/39c6ce92c659f6aaeed1d295138f8c567a6be4f0/src/zkscript/elliptic_curves/secp256k1/secp256k1.py#L363): script used to verify that $Q = bG$, where $G$ is the generator of secp256k1.
- [`verify_point_multiplication_up_to_sign`](https://github.com/nchain-innovation/zkscript_package/blob/39c6ce92c659f6aaeed1d295138f8c567a6be4f0/src/zkscript/elliptic_curves/secp256k1/secp256k1.py#L461): script used to verify that $Q = \pm bP$, where $Q, P$ are points on secp256k1.
- [`verify_point_multiplication`](https://github.com/nchain-innovation/zkscript_package/blob/39c6ce92c659f6aaeed1d295138f8c567a6be4f0/src/zkscript/elliptic_curves/secp256k1/secp256k1.py#L775): script used to verify that $Q = bP$, where $Q, P$ are points on secp256k1.

Some of the scripts above have restrictions on the point $Q, P$ that can be supplied. We refer to the documentation, the blogpost [OP_CHECKSIG beyond signature validation: efficient operations on the Bitcoin curve](https://hackmd.io/@federicobarbacovi/BkxI6ZvVye), and the issue [#52](https://github.com/nchain-innovation/zkscript_package/issues/52) for a detailed explanation of the algorithm, and of the restrictions.

The unlocking scripts for the methods contained in the class `Secp256k1` can be generated using the unlocking keys found in [src/zkscript/types/unlocking_keys/secp256k1.py](../src/zkscript/types/unlocking_keys/secp256k1.py). There are three unlocking keys, one for each script:
- [`Secp256k1BasePointMultiplicationUnlockingKey`](https://github.com/nchain-innovation/zkscript_package/blob/39c6ce92c659f6aaeed1d295138f8c567a6be4f0/src/zkscript/types/unlocking_keys/secp256k1.py#L12), for the script generated by the method `verify_base_point_multiplication`.
- [`Secp256k1PointMultiplicationUpToSignUnlockingKey`](https://github.com/nchain-innovation/zkscript_package/blob/39c6ce92c659f6aaeed1d295138f8c567a6be4f0/src/zkscript/types/unlocking_keys/secp256k1.py#L50), for the script generated by the method `verify_point_multiplication_up_to_sign`.
- [`Secp256k1PointMultiplicationUnlockingKey`](https://github.com/nchain-innovation/zkscript_package/blob/39c6ce92c659f6aaeed1d295138f8c567a6be4f0/src/zkscript/types/unlocking_keys/secp256k1.py#L105C7-L105C47), for the script generated by the method `verify_point_multiplication`.