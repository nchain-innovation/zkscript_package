# Efficient operations on secp256k1

The class [`Secp256k1`](../src/zkscript/elliptic_curves/secp256k1/secp256k1.py#L41) implements methods to efficiently verify scalar point multiplications on the curve secp256k1.

All the methods implemented by `Secp256k1` are class methods. The following public methods are implemented:
- [`verify_base_point_multiplication`](../src/zkscript/elliptic_curves/secp256k1/secp256k1.py#L365): script used to verify that $Q = bG$, where $G$ is the generator of secp256k1.
- [`verify_point_multiplication_up_to_sign`](../src/zkscript/elliptic_curves/secp256k1/secp256k1.py#L464): script used to verify that $Q = \pm bP$, where $Q, P$ are points on secp256k1.
- [`verify_point_multiplication`](../src/zkscript/elliptic_curves/secp256k1/secp256k1.py#L779): script used to verify that $Q = bP$, where $Q, P$ are points on secp256k1.

Some of the scripts above have restrictions on the point $Q, P$ that can be supplied. We refer to the documentation, the blogpost [OP_CHECKSIG beyond signature validation: efficient operations on the Bitcoin curve](https://hackmd.io/@federicobarbacovi/BkxI6ZvVye), and the issue [#52](https://github.com/nchain-innovation/zkscript_package/issues/52) for a detailed explanation of the algorithm, and of the restrictions.

The unlocking scripts for the methods contained in the class `Secp256k1` can be generated using the unlocking keys found in [src/zkscript/script_types/unlocking_keys/secp256k1.py](../src/zkscript/script_types/unlocking_keys/secp256k1.py). There are three unlocking keys, one for each script:
- [`Secp256k1BasePointMultiplicationUnlockingKey`](../src/zkscript/script_types/unlocking_keys/secp256k1.py#L12), for the script generated by the method `verify_base_point_multiplication`.
- [`Secp256k1PointMultiplicationUpToSignUnlockingKey`](../src/zkscript/script_types/unlocking_keys/secp256k1.py#L50), for the script generated by the method `verify_point_multiplication_up_to_sign`.
- [`Secp256k1PointMultiplicationUnlockingKey`](../src/zkscript/script_types/unlocking_keys/secp256k1.py#L105), for the script generated by the method `verify_point_multiplication`.